InFER: Inference For Epidemic related Risk
==========================================

%PACKAGE% version %VERSION% implements an MCMC sampler for a two-level mixing model
for the Australian Equine Influenza outbreak in 2007.

The code contained in this repository runs alongside research conducted between Warwick and Massey Universities.
The software is distributed under the GPLv3 license, allowing users to modify and redistribute the source code.  
It is provided WITHOUT WARRANTY and is intended for academic research purposes.

Copyright Chris Jewell <chrism0dwk@gmail.com> 2014

See $(PREFIX)/doc/%PACKAGE%/model.pdf for technical model details.

System requirements
====================

MPI library compatible with Boost::MPI >= 1.51.0
Boost >= 1.51.0 with boost_program_options, boost_serialization and boost_mpi compiled in.
GNU Scientific Library >= 1.15

Compiling
=========

%PACKAGE% is built using GNU Autotools.  The process is as follows:

$ tar zxvf %PACKAGE%-%VERSION%.tar.gz
$ cd %PACKAGE%-%VERSION%
$ ./configure
$ make
$ make install

Non-standard library locations
==============================

To point the build process at non-standard library locations
(e.g. for GSL and Boost), use the --with-gsl-prefix and --with-boost
options to configure. For example:

$ ./configure --with-gsl-prefix=/usr/local/packages/gsl-1.15 --with-boost=/usr/local/packages/boost_1_51_0

See ./configure --help for further options for selecting GSL and Boost locations.


Running %PACKAGE%
===================

%PACKAGE% provides the "auseiMcmc" binary which will be installed into "prefix" (see ./configure --help).  This 
binary provides some command line switches:

$ auseiMcmc --help
%PACKAGE% %VERSION% (c) 2014 Chris Jewell <chrism0dwk@gmail.com>

Allowed options:
  -h [ --help ]                display help message
  -c [ --config ] arg          xml config file (required)
  -n [ --niter ] arg (=10000)  number of iterations
  -s [ --seed ] arg (=0)       random seed
  -o [ --output ] arg (=ausei) output file prefix
  
The main configuration is set by using the -c switch.  See $(PREFIX)/share/%PACKAGE%/examples for 
an example config file which you can edit.  Change the values in this file, BUT DO NOT ALTER THE 
STRUCTURE OF THE XML.

The output files are named according to the output file prefix, with .parms and .occ appended.  This 
version of %PACKAGE% writes nothing to the .occ file, and the posterior draws for the parameters are 
contained in the .parms file.  The latter is CSV format, with the names of the parameters as column headings.
Each row then contains a sample of the chain for each iteration.

Since auseiMcmc is built using MPI, you can run it under 'mpirun' for parallel execution. The MCMC
algorithm requires /fast/ interconnects, so it is recommended to either run the package on a large
multicore machine, or on a specialised distributed HPC system.  For example:

$ mpirun -np 128 auseiMcmc -c myConf.xml


Population file format
======================

The population file uses a CSV file with column header.  The columns should be:

<id>, <easting>, <northing>, <num horses>, <property area>, <day of vaccination>

Epidemic file format
====================

The epidemic file is in CSV format with column headers.  The columns should be:

<id>, <infection day>, <onset day>

Notes
=====
1) The ids in the epidemic file must match those in the population file.
2) Days of infection, onset, and vaccination are in days since the first onset.  They
    are not dates.
3) The easting/northing coordinates should be in a Mercatorial projection that allows 
    calculation of Euclidean distance.  Since most coordinate systems use metres as the map unit,
    the algorithm automatically divides by 1000, to give units for parameter delta in km.





